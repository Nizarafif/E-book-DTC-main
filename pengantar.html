<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pengantar - DTC Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="min-h-screen bg-[#F5F5F5]">
    <!-- Layout: sidebar full-height, header/footer di kanan -->
    <main class="relative">
      <!-- Sidebar kiri full height -->
      <aside
        id="leftSidebar"
        class="fixed top-0 left-0 bottom-0 w-64 bg-[#113939] text-white overflow-y-auto z-30"
      >
        <div class="p-4 border-b border-white/10">
          <div class="flex items-start space-x-3">
            <img src="public/Cover Buku.svg" alt="Cover" class="w-24 h-32" />
            <div>
              <p class="text-xs opacity-80">KODE PRODUKSI/</p>
              <p class="text-sm font-semibold leading-tight">Nama Buku</p>
              <p class="text-[11px] opacity-90 mt-1">Nama Penyusun</p>
            </div>
          </div>
        </div>

        <nav class="text-sm">
          <button
            class="w-full px-4 py-3 hover:bg-white/10 border-b border-white/10 flex items-center text-left"
          >
            <img src="public/Icon list.svg" alt="List" class="w-4 h-4 mr-2" />
            <span>Daftar Isi</span>
          </button>

          <button
            class="w-full text-left px-4 py-3 hover:bg-white/10 border-b border-white/10"
          >
            01 PENGANTAR
          </button>

          <button
            class="w-full text-left px-4 py-3 hover:bg-white/10 border-b border-white/10"
          >
            02 Mindszet & Kiat
          </button>

          <button
            class="w-full text-left px-4 py-3 hover:bg-white/10 border-b border-white/10"
          >
            03 Daftar Isi
          </button>

          <!-- Dropdown Bab 1 -->
          <div class="border-b border-white/10">
            <button
              id="dropdownToggle"
              class="w-full text-left px-4 py-3 hover:bg-white/10 flex justify-between items-center"
            >
              <span>04 Bab 1 • PENDAHULUAN</span>
              <span id="arrow" class="transition-transform">▼</span>
            </button>

            <!-- isi dropdown -->
            <div id="dropdownMenu" class="hidden pl-8 pb-2">
              <button class="w-full text-left py-2 hover:bg-white/10 border-b border-gray-600">
                1.1 Latar Belakang
              </button>
              <button class="w-full text-left py-2 hover:bg-white/10  border-b border-gray-600">
                1.2 Tujuan
              </button>
              <button class="w-full text-left py-2 hover:bg-white/10  border-b border-gray-600">
                1.3 Manfaat
              </button>
            </div>
          </div>
        </nav>
      </aside>

      <script>
        const toggle = document.getElementById("dropdownToggle");
        const menu = document.getElementById("dropdownMenu");
        const arrow = document.getElementById("arrow");

        toggle.addEventListener("click", () => {
          menu.classList.toggle("hidden");
          arrow.classList.toggle("rotate-180");
        });
      </script>

      <!-- Area kanan -->
      <section class="ml-64 min-h-screen flex flex-col relative">
        <!-- Header di kanan, full width area konten -->
        <div
          class="bg-[#EAD6A8] text-[#113939] top-0 w-full fixed toolbar-shadow z-20"
        >
          <div class="flex items-center justify-between px-4 py-2">
            <div class="flex items-center space-x-3">
              <button
                onclick="history.back()"
                class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10"
              >
                <span class="text-xl">&#x276E;</span>
              </button>
              <h1 class="font-semibold tracking-wide">PENGANTAR</h1>
            </div>
          </div>
        </div>
        <!-- Viewer utama (only this area scrolls) -->
        <div
          id="readerContainer"
          class="w-full flex items-center justify-center mt-12"
        >
          <div class="relative bg-white w-full lg:w-[55%]">
            <img
              id="pageImage"
              src="public/Draft%20Buku%20SMM%20Bab%201.png"
              alt="Pengantar"
              class="w-full h-full object-cover"
            />
            <!-- Floating selection toolbar -->
            <div id="selectionToolbar" class="hidden fixed items-center space-x-1.5 bg-white/95 backdrop-blur-sm border border-black/10 rounded shadow px-2 py-1 z-30">
              <button id="tbSearch" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10" title="Cari">
                <img src="public/Buttton_Search_Field.svg" alt="Cari" class="w-4 h-4" />
              </button>
              <button id="tbNote" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10" title="Catatan">
                <img src="public/Icon Notes.svg" alt="Catatan" class="w-4 h-4" />
              </button>
              <!-- Color highlight buttons -->
              <button id="tbHighlightYellow" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10 border-2 border-gray-300" title="Highlight Kuning" style="background-color: #FEF08A;">
                <div class="w-3 h-3 rounded-full" style="background-color: #FDE047;"></div>
              </button>
              <button id="tbHighlightGreen" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10 border-2 border-gray-300" title="Highlight Hijau" style="background-color: #BBF7D0;">
                <div class="w-3 h-3 rounded-full" style="background-color: #4ADE80;"></div>
              </button>
              <button id="tbHighlightBlue" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10 border-2 border-gray-300" title="Highlight Biru" style="background-color: #BFDBFE;">
                <div class="w-3 h-3 rounded-full" style="background-color: #3B82F6;"></div>
              </button>
              <button id="tbHighlightPink" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10 border-2 border-gray-300" title="Highlight Pink" style="background-color: #FCE7F3;">
                <div class="w-3 h-3 rounded-full" style="background-color: #EC4899;"></div>
              </button>
              <button id="tbClear" class="w-7 h-7 flex items-center justify-center rounded hover:bg-black/10" title="Hapus Sorotan">
                <img src="public/out.svg" alt="Hapus" class="w-4 h-4" />
              </button>
            </div>
            <div class="absolute z-10 overflow-auto p-3 sm:p-4" style="top:160px; bottom:110px; left:0; right:0;">
              <div id="introText" class="px-1 sm:px-2 md:px-6 lg:px-8 py-2 sm:py-3 text-[#113939] leading-relaxed text-xs max-w-[720px] mx-auto" style="text-align: justify;">
              <h2 class="font-bold text-sm mb-2">Selamat bergabung di Fundamental Class Social Media Marketing!</h2>
              <p class="mb-2">Buku ini diperuntukkan untuk kamu generasi yang ingin belajar Sosial Media Marketing Communication. Ngga cuma belajar bikin konten, disini kamu juga bakal ngerti fundamental komunikasi pemasaran itu seperti apa? Komplit banget kan? Karena Sosial Media itu hanya 'wadahnya', dengan memehami fundamental, suatu saat zaman berubah dan berganti media, kita akan tetap relevan dan dapat mengerjakannya.</p>
              <p class="mb-2">Disini semua adalah potensial winner, karena semua belajar bersama dari awal. Kalau kamu bisa memahami dan menaklukan semua step yang ada, kamu bakal dapat:</p>
              <ul class="list-disc list-inside pl-6 space-y-1.5 mb-2">
                <li>Membuat Fundamental Pesan Pemasaran</li>
                <li>Bikin ide konten yang ngga ngasal</li>
                <li>Mampu produksi konten foto, desain, sampai video</li>
                <li>Paham cara mengukur kinerja sosial media marketing</li>
              </ul>
              <p>Itu semua bisa yakin akan bisa dikuasai asal kamu niat, konsisten dan disipilin! Semua materi dibuku ini akan maksimal jika diimbangi dengan praktek, dan hasilnya ada ditangan kamu, jadi SEMANGAT RAWRR!!!</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Toolbar bawah di kanan, full width area konten -->
        <div class="fixed bottom-0 left-64 right-0 bg-[#EAD6A8] toolbar-shadow z-20">
          <div class="flex items-center px-4 py-1">
            <!-- cluster kiri: Sebelumnya -->
            <div class="flex-1 flex items-center">
              <button id="prevBtn" class="flex items-center space-x-2 px-3 py-0.5 rounded hover:bg-black/10 text-[#113939]">
                <img src="public/Polygon 2.svg" alt="Prev" class="w-3 h-3 rotate-180" />
                <span>Sebelumnya</span>
              </button>
            </div>

            <!-- ikon tengah -->
            <div class="flex items-center justify-center space-x-8">
              <button
                class="w-10 h-10 flex items-center justify-center hover:scale-110 transition"
                title="Cari"
              >
                <img
                  src="public/Buttton_Search_Field.svg"
                  class="w-10 h-10"
                  alt="Search"
                />
              </button>
              <button
                class="w-9 h-9 flex items-center justify-center hover:scale-110 transition"
                title="Catatan"
              >
                <img src="public/Icon Notes.svg" class="w-7 h-7" alt="Notes" />
              </button>
              <button
                class="w-9 h-9 flex items-center justify-center hover:scale-110 transition"
                title="Highlight"
                id="highlightBtn"
              >
                <img
                  src="public/Icon Highlight.svg"
                  class="w-7 h-7"
                  alt="Highlight"
                />
              </button>
              <!-- tombol highlight/hapus di footer disembunyikan; diganti toolbar mengambang saat seleksi -->
            </div>

            <!-- cluster kanan: indikator dan Selanjutnya -->
            <div
              class="flex-1 flex items-center justify-end space-x-3 text-[#113939]"
            >
              <span id="pageIndicator" class="text-sm font-semibold">2/18</span>
              <button
                id="nextBtn"
                class="flex items-center space-x-2 px-3 py-0.5 rounded hover:bg-black/10"
              >
                <span>Selanjutnya</span>
                <img src="public/Polygon 2.svg" alt="Next" class="w-3 h-3" />
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      // Pagination indicator only
      const totalPages = 18;
      let currentPage = 2;
      const pageIndicator = document.getElementById("pageIndicator");
      const reader = document.getElementById("readerContainer");
      const nextBtn = document.getElementById("nextBtn");
      const prevBtn = document.getElementById("prevBtn");
      function updatePage(delta) {
        const next = Math.min(totalPages, Math.max(1, currentPage + delta));
        if (next === currentPage) return;
        currentPage = next;
        pageIndicator.textContent = `${currentPage}/${totalPages}`;
        reader.scrollTo({ top: 0, behavior: "smooth" });
      }
      if (nextBtn) nextBtn.addEventListener("click", () => { window.location.href = "mindset dan kiat.html"; });
      if (prevBtn) prevBtn.addEventListener("click", () => { window.location.href = "Tinjauan Pustaka.html"; });

      // Floating selection toolbar: Cari, Catatan, Highlight dengan pilihan warna, Hapus
      (function(){
        const intro = document.getElementById('introText');
        const toolbar = document.getElementById('selectionToolbar');
        const btnHighlightYellow = document.getElementById('tbHighlightYellow');
        const btnHighlightGreen = document.getElementById('tbHighlightGreen');
        const btnHighlightBlue = document.getElementById('tbHighlightBlue');
        const btnHighlightPink = document.getElementById('tbHighlightPink');
        const btnClear = document.getElementById('tbClear');
        const btnSearch = document.getElementById('tbSearch');
        const btnNote = document.getElementById('tbNote');
        if (!intro || !toolbar) return;
        // Footer highlight button mirrors the floating toolbar behavior
        const footerHighlightBtn = document.getElementById('highlightBtn');

        function applyHighlight(color = '#FDE047'){
          const selection = window.getSelection();
          if (!selection || selection.isCollapsed) return;
          const range = selection.getRangeAt(0);
          const containerNode = range.commonAncestorContainer;
          if (!intro.contains(containerNode)) return;
          const span = document.createElement('span');
          span.style.backgroundColor = color;
          span.style.padding = '0 2px';
          span.style.borderRadius = '2px';
          span.className = 'text-highlight';
          const contents = range.extractContents();
          span.appendChild(contents);
          range.insertNode(span);
          selection.removeAllRanges();
        }
        function unwrap(node){
          const parent = node.parentNode;
          if (!parent) return;
          while (node.firstChild) parent.insertBefore(node.firstChild, node);
          parent.removeChild(node);
        }
        function removeHighlights(){
          const selection = window.getSelection();
          const spans = Array.from(intro.querySelectorAll('.text-highlight'));
          if (!selection || selection.isCollapsed){
            spans.forEach(unwrap);
            return;
          }
          const range = selection.getRangeAt(0);
          spans.forEach(function(s){
            try { if (range.intersectsNode(s)) unwrap(s); }
            catch(e) { unwrap(s); }
          });
          selection.removeAllRanges();
        }
        function getSelectionRect(){
          const sel = window.getSelection();
          if (!sel || sel.rangeCount === 0) return null;
          const range = sel.getRangeAt(0).cloneRange();
          if (range.collapsed) return null;
          const rects = range.getClientRects();
          if (!rects || rects.length === 0) return null;
          return rects[rects.length - 1];
        }
        function showToolbar(){
          const rect = getSelectionRect();
          if (!rect){ hideToolbar(); return; }
          const offsetY = 8;
          toolbar.style.left = Math.max(8, rect.left + window.scrollX) + 'px';
          toolbar.style.top = rect.bottom + window.scrollY + offsetY + 'px';
          toolbar.classList.remove('hidden');
          toolbar.style.display = 'flex';
        }
        function hideToolbar(){
          toolbar.classList.add('hidden');
          toolbar.style.display = 'none';
        }
        document.addEventListener('selectionchange', function(){
          const sel = window.getSelection();
          if (!sel || sel.isCollapsed) { hideToolbar(); return; }
          const anchorEl = sel.anchorNode && sel.anchorNode.nodeType === 3 ? sel.anchorNode.parentElement : sel.anchorNode;
          if (anchorEl && intro.contains(anchorEl)) showToolbar();
          else hideToolbar();
        });
        document.addEventListener('scroll', function(){
          const sel = window.getSelection();
          if (!sel || sel.isCollapsed) { hideToolbar(); return; }
          showToolbar();
        }, true);
        document.addEventListener('click', function(e){
          if (toolbar.contains(e.target)) return;
          const sel = window.getSelection();
          if (!sel || sel.isCollapsed) hideToolbar();
        });

        if (btnHighlightYellow) btnHighlightYellow.addEventListener('click', function(e){ e.preventDefault(); applyHighlight('#FDE047'); hideToolbar(); });
        if (btnHighlightGreen) btnHighlightGreen.addEventListener('click', function(e){ e.preventDefault(); applyHighlight('#4ADE80'); hideToolbar(); });
        if (btnHighlightBlue) btnHighlightBlue.addEventListener('click', function(e){ e.preventDefault(); applyHighlight('#3B82F6'); hideToolbar(); });
        if (btnHighlightPink) btnHighlightPink.addEventListener('click', function(e){ e.preventDefault(); applyHighlight('#EC4899'); hideToolbar(); });
        if (footerHighlightBtn) footerHighlightBtn.addEventListener('click', function(e){ e.preventDefault(); applyHighlight('#FDE047'); });
        if (btnClear) btnClear.addEventListener('click', function(e){ e.preventDefault(); removeHighlights(); hideToolbar(); });
        if (btnSearch) btnSearch.addEventListener('click', function(e){ e.preventDefault(); const sel = window.getSelection(); if (sel && !sel.isCollapsed){ const q = sel.toString(); window.open('https://www.google.com/search?q=' + encodeURIComponent(q), '_blank'); hideToolbar(); } });
        if (btnNote) btnNote.addEventListener('click', function(e){ e.preventDefault(); alert('Fitur catatan akan ditambahkan.'); hideToolbar(); });
      })();
    </script>
  </body>
  </html>
